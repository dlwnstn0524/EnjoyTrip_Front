<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Enjoy Your Trip!</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <script src="./assets/js/component.js"></script>

    <style>
      .input-form {
        max-width: 680px;

        margin-top: 80px;
        padding: 32px;

        background: #fff;
        -webkit-border-radius: 10px;
        -moz-border-radius: 10px;
        border-radius: 10px;
        -webkit-box-shadow: 0 8px 20px 0 rgba(0, 0, 0, 0.15);
        -moz-box-shadow: 0 8px 20px 0 rgba(0, 0, 0, 0.15);
        box-shadow: 0 8px 20px 0 rgba(0, 0, 0, 0.15);
      }
    </style>
  </head>

  <body>
    <div id="header">
      <nav class="navbar navbar-expand-lg navbar-light bg-light shadow fixed-top">
        <div class="container">
          <a class="navbar-brand text-primary fw-bold" href="main.html">
            <img src="./assets/img/logo.PNG" alt="" width="60" />
            EnjoyTrip!
          </a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-lg-0">
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="public_data.html">지역별관광지</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="#">나의여행계획</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="#">핫플자랑하기</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="#">여행정보공유</a>
              </li>
            </ul>
            <!-- 로그인 전 -->
            <ul class="navbar-nav mb-2 me-2 mb-lg-0" id="logoutstate">
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="join.html">회원가입</a>
              </li>
              <li class="nav-item" data-bs-toggle="modal" data-bs-target="#exampleModal">
                <a class="nav-link" aria-current="page" href="#">로그인</a>
              </li>
            </ul>
            <!-- 로그인 후 -->
            <ul class="navbar-nav mb-2 me-2 mb-lg-0" id="loginstate">
              <li class="nav-item">
                <a
                  class="nav-link"
                  aria-current="page"
                  href="/main.html"
                  onclick="javascript:logout();"
                  >로그아웃</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="#">마이페이지</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <!-- Modal -->
      <div
        class="modal fade"
        id="exampleModal"
        tabindex="-1"
        aria-labelledby="exampleModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="exampleModalLabel">로그인</h1>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <div class="mb-3">
                <label for="userId">아이디 : </label>
                <input type="text" class="form-control" id="inputId" required />
                <div class="invalid-feedback">아이디를 입력해주세요.</div>
              </div>

              <div class="mb-3">
                <label for="password">비밀번호 : </label>
                <input type="password" class="form-control" id="inputPw" required />
                <div class="invalid-feedback">비밀번호를 입력해주세요.</div>
              </div>
            </div>
            <div class="justify-content-end">
              <div class="d-flex justify-content-end me-2 mb-2">
                <div class="">
                  <label for="name"></label>
                  <button
                    type="submit"
                    class="btn btn-outline-primary"
                    id="LOGIN"
                    onclick="javascript:login();"
                  >
                    로그인
                  </button>
                </div>
                <div class="">
                  <label for="findId"></label>
                  <button type="submit" class="btn btn-outline-success">ID찾기</button>
                </div>
                <div class="">
                  <label for="findPassword"></label>
                  <button type="submit" class="btn btn-outline-secondary">PW찾기</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--상단바 끝-->
    <div class="container">
      <div class="input-form-backgroud row">
        <div class="input-form col-md-12 mx-auto">
          <h4 class="mb-3">마이페이지</h4>
          <form class="validation-form" novalidate>
            <div class="mb-3">
              <label for="name">이름</label>
              <input type="text" class="form-control" id="name" required />
            </div>

            <div class="mb-3">
              <label for="userId">아이디</label>
              <input type="text" class="form-control" id="userid" required />
              <div class="invalid-feedback">아이디를 입력해주세요.</div>
            </div>

            <div class="mb-3">
              <label for="password">비밀번호</label>
              <input type="password" class="form-control" id="passWord" required />
              <div class="invalid-feedback">비밀번호를 입력해주세요.</div>
            </div>

            <div class="mb-3">
              <label for="checkPassword">비밀번호 확인</label>
              <input type="password" class="form-control" id="checkPassword" required />
              <div class="invalid-feedback">비밀번호를 재입력해주세요.</div>
            </div>

            <div class="mb-3">
              <label for="email">이메일</label>
              <input
                type="email"
                class="form-control"
                placeholder="you@example.com"
                id="email"
                required
              />
            </div>

            <div class="mb-3">
              <label for="address">지역</label>
              <input type="text" class="form-control" id="region" required />
            </div>

            <div class="row mr-auto" style="float: right">
              <div class="col">
                <label for="name"></label>
                <input type="submit" class="btn btn-outline-primary" value="수정"></input>
              </div>
              <div class="col">
                <label for="name"></label>
                <input type="reset" class="btn btn-outline-success" value="회원탈퇴"></input>
              </div>
            </div>
          </form>
        </div>
      </div>
      <footer class="my-3 text-center text-small">
        <p class="mb-1">&copy; Copyright By Jiu Kang</p>
      </footer>
    </div>

    <footer class="navbar navbar-expand-lg navbar-light bg-light justify-content-around">
      <div>
        <img src="/assets/img/footer.png" alt="" width="70px" />
      </div>
      <div class="row">
        <ul class="navbar-nav">
          <li><a href="#" class="nav-link text-secondary">인사말</a></li>
          <li><a href="#" class="nav-link text-secondary">개인정보처리방침</a></li>
          <li><a href="#" class="nav-link text-secondary">이용약관</a></li>
          <li><a href="#" class="nav-link text-secondary">오시는길</a></li>
          <li><label class="nav-link text-secondary">&copy; SSAFY Corp.</label></li>
        </ul>
      </div>
    </footer>
    

    <!-- validation-form -->
    <!-- 사용자 입력값에 따른 유효성 검사 -->
    <script>
      function handleSubmit(event) {
        event.preventDefault(); // 기본 동작 방지

        // 입력된 값 가져오기
        const name = document.getElementById('name').value;
        const userid = document.getElementById('userid').value;
        const passWord = document.getElementById('passWord').value;
        const checkPassword = document.getElementById('checkPassword').value;
        const email = document.getElementById('email').value;
        const region = document.getElementById('region').value;
        console.log(passWord)
        if ( passWord != checkPassword) {
          alert('비밀번호가 일치하지 않습니다.');
          return;
        }
        if (this.checkValidity() === false) {
          return;
        }
        
        this.classList.add("was-validated");

        // 사용자 데이터 생성
        const userData = {
          name,
          userid,
          pw,
          email,
          region,
        };

        // localStorage에 데이터 저장
        localStorage.setItem("register", JSON.stringify(userData));

        // 성공 메시지 표시
        alert('회원 정보 수정이 완료되었습니다.');
        window.location.href = 'main.html';
      }

      window.addEventListener(
        "load",
        () => {
          const forms = document.getElementsByClassName("validation-form");
          forms[0].addEventListener("submit", handleSubmit, false);
        },
        false
      );
      
      window.onload = function() {

const session = JSON.parse(localStorage.getItem("isLogin"));
console.log(session);
if (session == true) {
  const wrapper = document.querySelector("#loginstate");
  wrapper.setAttribute("style", "display:flex");
  const wrapper1 = document.querySelector("#logoutstate");
  wrapper1.setAttribute("style", "display:none");
} else {
  const wrapper = document.querySelector("#logoutstate");
  wrapper.setAttribute("style", "display:flex");
  const wrapper1 = document.querySelector("#loginstate");
  wrapper1.setAttribute("style", "display:none");
}
}



function login() {
const inputId = document.querySelector("#inputId").value;
const inputPw = document.querySelector("#inputPw").value;
console.log(inputId);
console.log(inputPw);

const data = JSON.parse(localStorage.getItem("register"));
const id = data.userid;
const pw = data.passWord;

console.log(id);
console.log(pw);
if (inputId === id && inputPw === pw) {
  alert("로그인 성공!");
  window.location.href = 'main.html';
  localStorage.setItem("isLogin", JSON.stringify(true));
  const wrapper = document.querySelector("#loginstate");
  wrapper.setAttribute("style", "display:block");
  wrapper = document.querySelector("#logoutstate");
  wrapper.setAttribute("style", "display:none");
} else {
  alert("아이디 비밀번호를 확인해주세요");
}
}

function logout() {
localStorage.setItem("isLogin", JSON.stringify(false));
return;
}


    </script>
  </body>
</html>